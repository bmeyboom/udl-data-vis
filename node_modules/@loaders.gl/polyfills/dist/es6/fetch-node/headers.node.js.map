{"version":3,"sources":["../../../src/fetch-node/headers.node.js"],"names":["Headers","constructor","headers","map","forEach","value","name","append","Array","isArray","header","Object","getOwnPropertyNames","normalizeName","normalizeValue","oldValue","delete","get","has","hasOwnProperty","set","visitor","thisArg","call","keys","items","push","iteratorFor","values","entries","Symbol","iterator","String","test","TypeError","toLowerCase","next","shift","done","undefined"],"mappings":"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","sourcesContent":["/**\n * Polyfill for Browser Headers\n * Based on https://github.com/github/fetch under MIT license\n */\nexport default class Headers {\n  constructor(headers) {\n    this.map = {};\n\n    if (headers instanceof Headers) {\n      headers.forEach((value, name) => this.append(name, value));\n    } else if (Array.isArray(headers)) {\n      headers.forEach(header => this.append(header[0], header[1]));\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(name => this.append(name, headers[name]));\n    }\n  }\n\n  append(name, value) {\n    name = normalizeName(name);\n    value = normalizeValue(value);\n    const oldValue = this.map[name];\n    this.map[name] = oldValue ? `${oldValue}, ${value}` : value;\n  }\n\n  delete(name) {\n    delete this.map[normalizeName(name)];\n  }\n\n  get(name) {\n    name = normalizeName(name);\n    return this.has(name) ? this.map[name] : null;\n  }\n\n  has(name) {\n    return this.map.hasOwnProperty(normalizeName(name));\n  }\n\n  set(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value);\n  }\n\n  forEach(visitor, thisArg = null) {\n    for (const name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        if (thisArg) {\n          visitor.call(thisArg, this.map[name], name, this);\n        } else {\n          visitor(this.map[name], name, this);\n        }\n      }\n    }\n  }\n\n  keys() {\n    const items = [];\n    this.forEach(function(value, name) {\n      items.push(name);\n    });\n    return iteratorFor(items);\n  }\n\n  values() {\n    const items = [];\n    this.forEach(function(value) {\n      items.push(value);\n    });\n    return iteratorFor(items);\n  }\n\n  entries() {\n    const items = [];\n    this.forEach(function(value, name) {\n      items.push([name, value]);\n    });\n    return iteratorFor(items);\n  }\n\n  *[Symbol.iterator]() {\n    // @ts-ignore must have a '[Symbol.iterator]()' method that returns an iterator.\n    yield* this.entries();\n  }\n}\n\nfunction normalizeName(name) {\n  if (typeof name !== 'string') {\n    name = String(name);\n  }\n  if (/[^a-z0-9\\-#$%&'*+.^_`|~]/i.test(name) || name === '') {\n    throw new TypeError('Invalid character in header field name');\n  }\n  return name.toLowerCase();\n}\n\nfunction normalizeValue(value) {\n  if (typeof value !== 'string') {\n    value = String(value);\n  }\n  return value;\n}\n\n// Build a destructive iterator for the value list\nfunction iteratorFor(items) {\n  const iterator = {\n    next() {\n      const value = items.shift();\n      return {done: value === undefined, value};\n    }\n  };\n\n  iterator[Symbol.iterator] = function() {\n    return iterator;\n  };\n\n  return iterator;\n}\n"],"file":"headers.node.js"}